var Je=Object.defineProperty;var et=(t,e,s)=>e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var S=(t,e,s)=>(et(t,typeof e!="symbol"?e+"":e,s),s);import{k as tt,j as n,m as he,f as ge,C as ue,u as st,B as de,S as rt,s as _,r as c,Q as G,a as T,b as Ne,M as $e,d as me,T as P,X as at,N as nt,Y as Ae,Z as ot,$ as lt,I as ct,R as Q,p as it,F as Ie,a0 as ut,G as dt,c as Oe}from"./index-204de1e1.js";import{f as Ve,A as ft,a as ht,b as gt,T as mt,S as vt,g as bt,u as pt,c as xt,d as St,e as Ct,h as jt,i as kt,j as wt,k as Rt}from"./api-1e3c0728.js";import{C as fe}from"./Checkbox-547987d2.js";import{S as yt}from"./Select-9b57d731.js";import{u as Et,P as ie}from"./Popover-b42aea45.js";import"./get-select-right-section-props-cd7c750e.js";import"./use-input-props-c69f8d8f.js";const zt=tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ve=({indeterminate:t,...e})=>n.jsx(fe,{...e});class Ft{constructor(){S(this,"opened",!1);S(this,"isAllColumns",!0);S(this,"columns",[{id:0,label:"checkbox",value:"checkbox",checked:!0},{id:1,label:"ФИО",value:"fullname",checked:!0},{id:2,label:"Роль",value:"role",checked:!0},{id:3,label:"Член группы",value:"student",checked:!0,prevChecked:!0},{id:4,label:"Группа",value:"user_group",checked:!0,prevChecked:!0},{id:5,label:"Количество транскрибаций",value:"transcribations_created",checked:!0},{id:6,label:"Количество верификаций",value:"transcribations_validated",checked:!0},{id:7,label:"Количество классификаций",value:"audio_classified",checked:!0},{id:8,label:"Количество сегментаций",value:"audio_labeled",checked:!0},{id:9,label:"Общее количество",value:"transcribations_total",checked:!0},{id:10,label:"Процент корректных",value:"transcribations_correct",checked:!0}]);S(this,"toggleAllColumns",()=>{this.isAllColumns=!this.isAllColumns,this.columns=this.columns.map(e=>({...e,checked:this.isAllColumns}))});S(this,"setColumns",(e,s,a)=>{this.columns=this.columns.map(r=>a&&e===r.label?{...r,checked:s,prevChecked:s}:r.label===e?{...r,checked:s}:r),this.isAllColumns=this.columns.every(r=>r.checked)});S(this,"setOpenColumnsEdtior",e=>{this.opened=e});he(this)}}const Y=new Ft,be=ge(t=>{const e=t.colorScheme==="dark";return{container:{flex:1,whiteSpace:"nowrap",borderRadius:"10px",position:"static",overflow:"auto","::-webkit-scrollbar":{height:"7px",width:"7px",background:e?"#1C1E26":"inherit"},"::-webkit-scrollbar:horizontal":{borderRadius:"0 0 0 10px"},"::-webkit-scrollbar:vertical":{borderRadius:"0 10px 0 0"},"::-webkit-scrollbar-corner":{width:"10px",height:"10px",borderRadius:"0 0 10px 0",background:e?"#1C1E26":"white"},"::-webkit-scrollbar-thumb":{backgroundColor:e?t.colors.darkGray[4]:t.colors.darkGray[1],borderRadius:"10px"}},table:{position:"static",justifyContent:"center",textAlign:"center",backgroundColor:e?"#1C1E26":"white",color:e?t.colors.gray[4]:"black","thead, tbody":{"th, td":{borderLeft:`.7px solid ${e?t.colors.dark[4]:t.colors.gray[4]}`,borderRight:`.7px solid ${e?t.colors.dark[4]:t.colors.gray[4]}`,":last-of-type":{borderRight:"none"},":first-of-type":{borderLeft:"none"},cursor:"pointer"}}},tableHead:{background:e?"#1C1E26":"white",position:"sticky",zIndex:1,left:0,top:0,"::after":{content:'""',position:"absolute",left:0,bottom:0,height:".7px",background:e?t.colors.dark[4]:t.colors.gray[4],width:"100%"}},tableHeadThChildren:{gap:"8px",color:e?t.colors.gray[3]:"black",fontWeight:500,width:"100%",padding:"10px",textAlign:"center"},headTagDefault:{color:e?t.colors.dark[3]:t.colors.gray[5]},headTag:{color:e?"#5C5F66":t.colors.gray[5],width:14,height:14},tableBodyTr:{":hover":{background:e?"#252832":"#DEE2E640"}},tableHighlitedRow:{background:t.colorScheme==="dark"?"rgba(41, 100, 155, 0.10)":"rgba(231, 245, 255, 0.50)"},checkbox:{margin:"auto",width:0}}}),Tt=({table:t,onClick:e})=>{const{classes:s}=be();return n.jsx("thead",{className:s.tableHead,children:t.getHeaderGroups().map(a=>n.jsx("tr",{children:a.headers.map(r=>n.jsx("th",{colSpan:r.colSpan,children:r.id==="checkbox"?n.jsx(ue,{className:s.tableHeadThChildren,children:n.jsx(ve,{onClick:e,checked:t.getIsAllRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler()})}):n.jsxs(ue,{className:s.tableHeadThChildren,onClick:r.column.getToggleSortingHandler(),children:[r.isPlaceholder?null:Ve(r.column.columnDef.header,r.getContext()),{asc:n.jsx(ft,{className:s.headTag}),desc:n.jsx(ht,{className:s.headTag})}[r.column.getIsSorted()]??n.jsx(gt,{className:s.headTag})]})},r.id))},a.id))})},Mt=({padding:t,virtualRows:e,rows:s,highlitedRows:a,selectRow:r})=>{const o=st(),{classes:l}=be();return n.jsxs("tbody",{children:[t.top>0&&n.jsx("tr",{children:n.jsx("td",{style:{height:`${t.top}px`}})}),e.map(u=>{const d=s[u.index];return n.jsx("tr",{className:a.includes(d.id)?l.tableHighlitedRow:l.tableBodyTr,children:d.getVisibleCells().map(i=>i.id===`${i.row.id}_checkbox`?n.jsx("td",{style:{borderTop:0},children:n.jsx(ue,{className:l.checkbox,children:n.jsx(ve,{checked:d.getIsSelected(),onClick:()=>r(d.id),onChange:d.getToggleSelectedHandler()})})},i.id):n.jsx("td",{style:{padding:0,borderTop:0,minWidth:i.id===`${i.row.id}_fullname`?"300px":"140px"},children:n.jsx(de,{p:15,onClick:()=>o(`${rt.admin}/${i.row.original.id}`),children:Ve(i.column.columnDef.cell,i.getContext())})},i.id))},d.id)}),t.bottom>0&&n.jsx("tr",{children:n.jsx("td",{style:{height:`${t.bottom}px`}})})]})},Pt=_(({table:t,rows:e,virtualRows:s,tableContainerRef:a,loading:r,padding:o})=>{const{classes:l}=be(),{columns:u}=Y;c.useEffect(()=>{const g=Object.assign({},...u.map(p=>({[p.value]:p.checked})));t.setColumnVisibility(g)},[t,u]);const[d,i]=c.useState([]),v=g=>d.includes(g)?i(d.filter(p=>p!==g)):i([...d,g]);return n.jsx(G,{className:l.container,visible:r,ref:a,children:n.jsxs(mt,{className:l.table,children:[n.jsx(Tt,{table:t,onClick:()=>i([])}),n.jsx(Mt,{padding:o,virtualRows:s,rows:e,highlitedRows:d,selectRow:v})]})})});class _t{constructor(){S(this,"users",[]);S(this,"permissionEditorOpened",!1);S(this,"projectsEditorOpened",!1);S(this,"setUsers",e=>{this.users=e});S(this,"togglePermissionsEditor",()=>{this.permissionEditorOpened=!this.permissionEditorOpened});S(this,"toggleProjectsEditor",()=>{this.projectsEditorOpened=!this.projectsEditorOpened});he(this)}}const Z=new _t,Ot=_(()=>{const{permissionEditorOpened:t,togglePermissionsEditor:e,users:s}=Z,[a,r]=c.useState({transcribation:"user_allow",validation:"user_allow",classify:"user_allow",label:"user_allow"}),[o,l]=c.useState(!1),{t:u}=T(),{successNotification:d,errorNotification:i}=Ne(),v=()=>{if(s.length){const p=s.map(C=>C.id),f={id_list:p,...a};ot(f).then(()=>{d(u("Права пользователя были сохранены."))}).catch(()=>{i(u("Что-то пошло не так."))}),o&&lt(p),e()}else i(u("Выберите пользователей."))},g=()=>{e()};return n.jsxs($e,{opened:t,onClose:g,withCloseButton:!1,centered:!0,children:[n.jsxs(me,{p:"0 26px 24px 10px",children:[n.jsx(P,{fw:500,children:u("Редактирование прав")}),n.jsx(P,{fz:12,children:u("Изменения будут применены к выбранным пользователям")}),n.jsx(at,{tasks:a,setTasks:r}),n.jsx(P,{fw:500,children:u("Выбор роли пользователя:")}),n.jsx(nt,{label:u("Администратор"),onChange:()=>l(!o)})]}),n.jsx(Ae,{close:g,saveRights:v})]})}),Be=()=>{const t=c.useContext(He);if(!t)throw new Error("useParamsContext must be used within ParamsProvider");return t},Ge=({param:t,searchParams:e,setSearchParams:s})=>({handleChange:r=>{e.set(t,(r==null?void 0:r.toString())??""),s(e)}});let Nt=class{constructor(){S(this,"tableUser","Все");S(this,"searched","");he(this)}setUser(e){this.tableUser=e}setSearched(e){this.searched=e}};const $=new Nt,$t=_(()=>{const{searchParams:t,setSearchParams:e}=Be(),{t:s}=T(),{handleChange:a}=Ge({param:"user",searchParams:t,setSearchParams:e}),{columns:r,setColumns:o}=Y,l=[{value:"Все",label:s("Все")},{value:"Член_группы",label:s("Член группы")},{value:"Не_член_группы",label:s("Не член группы")}];c.useEffect(()=>$.setUser(t.get("user")),[t]);const u=d=>{a(d),d!=="Не_член_группы"?(o("Член_группы",r[3].prevChecked),o("Группа",r[4].prevChecked)):(o("Член_группы",!1),o("Группа",!1))};return n.jsx(yt,{placeholder:s("Все"),value:$.tableUser,data:l,onChange:u,styles:{input:{borderRadius:10}}})}),At=_(()=>{const{searchParams:t,setSearchParams:e}=Be(),{t:s}=T(),{handleChange:a}=Ge({param:"search",searchParams:t,setSearchParams:e});return c.useEffect(()=>$.setSearched(t.get("search")),[t]),n.jsx(ct,{w:"30vw",styles:{input:{width:"100%",borderRadius:10}},value:$.searched??"",onChange:r=>a(r.target.value),placeholder:s("Поиск по ФИО"),icon:n.jsx(vt,{size:14})})}),He=c.createContext(void 0),It=({params:t,loading:e})=>n.jsxs(He.Provider,{value:t,children:[n.jsx(G,{w:"fit-content",visible:e,sx:{zIndex:1},children:n.jsx(At,{})}),n.jsx(G,{w:"fit-content",visible:e,sx:{zIndex:1},children:n.jsx($t,{})})]}),Vt=ge(t=>{const e=t.colorScheme==="dark";return{target:{color:`${e?t.colors.darkBlue[1]:t.colors.blue[5]}`,cursor:"pointer",gap:5,alignItems:"center",width:"fit-content",display:"flex"},title:{color:`${e?t.colors.darkBlue[1]:t.colors.blue[5]}`,fontWeight:500},dropdown:{borderRadius:"10px"}}}),Bt=_(({loading:t})=>{const{columns:e,toggleAllColumns:s,setColumns:a,setOpenColumnsEdtior:r,opened:o,isAllColumns:l}=Y,{classes:u}=Vt(),d=Et(()=>r(!1)),{t:i}=T();return n.jsxs(ie,{opened:o,children:[n.jsx(ie.Target,{children:n.jsxs(G,{visible:t,onClick:()=>r(!o),className:u.target,children:[n.jsx(P,{className:u.title,children:i("Столбцы таблицы")}),n.jsx(zt,{})]})}),n.jsx(ie.Dropdown,{className:u.dropdown,children:n.jsxs(me,{ref:d,spacing:15,children:[n.jsx(P,{children:i("Применяемые столбцы")}),n.jsx(fe,{label:i("Все столбцы"),checked:l,indeterminate:!l,onChange:s,variant:"filled"}),e.map(({id:v,label:g,checked:p})=>g==="checkbox"?null:n.jsx(fe,{label:i(g),checked:p,onChange:()=>a(g,!p,!0),variant:"filled"},v))]})})]})}),Gt=()=>{const{t}=T();return c.useMemo(()=>[{id:"checkbox",header:({table:e})=>n.jsx(ve,{checked:e.getIsAllRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()})},{accessorKey:"fullname",header:t("ФИО"),cell:e=>e.getValue()},{accessorKey:"role",header:t("Роль"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"student",header:t("Член группы"),cell:e=>n.jsx("div",{children:e.getValue()?t("Да"):t("Нет")}),enableGlobalFilter:!1},{accessorKey:"user_group",header:t("Группа"),cell:e=>e.getValue()},{accessorKey:"transcribations_created",header:t("Количество транскрибаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"transcribations_validated",header:t("Количество верификаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"audio_classified",header:t("Количество классификаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"audio_labeled",header:t("Количество сегментаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"transcribations_total",header:t("Общее количество"),cell:({row:e})=>Number(e.getValue("transcribations_created"))+Number(e.getValue("transcribations_validated"))+Number(e.getValue("audio_classified"))+Number(e.getValue("audio_labeled")),enableGlobalFilter:!1},{accessorKey:"transcribations_correct",header:t("Процент корректных"),cell:e=>`${(e.getValue()*100).toFixed(2)}%`,enableGlobalFilter:!1}],[t])},Ht=()=>{const[t,e]=c.useState([]),[s,a]=c.useState(!0),{t:r}=T();return c.useEffect(()=>{bt({student:!0,student_group:""}).then(({data:l})=>{e(l)}).catch(l=>l).finally(()=>a(!1))},[]),{data:c.useMemo(()=>t.map(l=>({...l,role:l.role==="admin"?r("Администратор"):r("Пользователь"),transcribations_total:l.transcribations_validated+l.transcribations_created})),[t,r]),loading:s}};/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function B(){return B=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},B.apply(this,arguments)}function Kt(t,e){if(t==null)return{};var s={},a=Object.keys(t),r,o;for(o=0;o<a.length;o++)r=a[o],!(e.indexOf(r)>=0)&&(s[r]=t[r]);return s}var Dt=["bottom","height","left","right","top","width"],Lt=function(e,s){return e===void 0&&(e={}),s===void 0&&(s={}),Dt.some(function(a){return e[a]!==s[a]})},F=new Map,Ke,Ut=function t(){var e=[];F.forEach(function(s,a){var r=a.getBoundingClientRect();Lt(r,s.rect)&&(s.rect=r,e.push(s))}),e.forEach(function(s){s.callbacks.forEach(function(a){return a(s.rect)})}),Ke=window.requestAnimationFrame(t)};function Wt(t,e){return{observe:function(){var a=F.size===0;F.has(t)?F.get(t).callbacks.push(e):F.set(t,{rect:void 0,hasRectChanged:!1,callbacks:[e]}),a&&Ut()},unobserve:function(){var a=F.get(t);if(a){var r=a.callbacks.indexOf(e);r>=0&&a.callbacks.splice(r,1),a.callbacks.length||F.delete(t),F.size||cancelAnimationFrame(Ke)}}}}var X=typeof window<"u"?c.useLayoutEffect:c.useEffect;function qt(t,e){var s=e.rect;return t.height!==s.height||t.width!==s.width?s:t}var Qt=function(e,s){s===void 0&&(s={width:0,height:0});var a=Q.useState(e.current),r=a[0],o=a[1],l=Q.useReducer(qt,s),u=l[0],d=l[1],i=Q.useRef(!1);return X(function(){e.current!==r&&o(e.current)}),X(function(){if(r&&!i.current){i.current=!0;var v=r.getBoundingClientRect();d({rect:v})}},[r]),Q.useEffect(function(){if(r){var v=Wt(r,function(g){d({rect:g})});return v.observe(),function(){v.unobserve()}}},[r]),u},Xt=["align"],Yt=function(){return 50},Zt=function(e){return e},Jt=function(e,s){var a=s?"offsetWidth":"offsetHeight";return e[a]},es=function(e){for(var s=Math.max(e.start-e.overscan,0),a=Math.min(e.end+e.overscan,e.size-1),r=[],o=s;o<=a;o++)r.push(o);return r},ts=function(e){var s,a=e.size,r=a===void 0?0:a,o=e.estimateSize,l=o===void 0?Yt:o,u=e.overscan,d=u===void 0?1:u,i=e.paddingStart,v=i===void 0?0:i,g=e.paddingEnd,p=g===void 0?0:g,f=e.parentRef,C=e.horizontal,O=C===void 0?!1:C,J=e.scrollToFn,ee=e.useObserver,k=e.initialRect,H=e.onScrollElement,A=e.scrollOffsetFn,K=e.keyExtractor,D=K===void 0?Zt:K,E=e.measureSize,L=E===void 0?Jt:E,pe=e.rangeExtractor,xe=pe===void 0?es:pe,De=O?"width":"height",U=O?"scrollLeft":"scrollTop",R=c.useRef({outerSize:0,scrollOffset:0,measurements:[],totalSize:0}),Se=c.useState(0),Le=Se[0],Ce=Se[1];R.current.scrollOffset=Le;var Ue=ee||Qt,We=Ue(f,k),qe=We[De];R.current.outerSize=qe;var I=c.useCallback(function(h){f.current&&(f.current[U]=h)},[f,U]),je=J||I,W=c.useCallback(function(h){je(h,I)},[I,je]),ke=c.useState({}),we=ke[0],te=ke[1],Qe=c.useCallback(function(){return te({})},[]),q=c.useRef([]),N=c.useMemo(function(){var h=q.current.length>0?Math.min.apply(Math,q.current):0;q.current=[];for(var x=R.current.measurements.slice(0,h),b=h;b<r;b++){var m=D(b),z=we[m],w=x[b-1]?x[b-1].end:v,y=typeof z=="number"?z:l(b),M=w+y;x[b]={index:b,start:w,size:y,end:M,key:m}}return x},[l,we,v,r,D]),Re=(((s=N[r-1])==null?void 0:s.end)||v)+p;R.current.measurements=N,R.current.totalSize=Re;var V=H?H.current:f.current,se=c.useRef(A);se.current=A,X(function(){if(!V){Ce(0);return}var h=function(b){var m=se.current?se.current(b):V[U];Ce(m)};return h(),V.addEventListener("scroll",h,{capture:!1,passive:!0}),function(){V.removeEventListener("scroll",h)}},[V,U]);var ye=rs(R.current),Ee=ye.start,ze=ye.end,re=c.useMemo(function(){return xe({start:Ee,end:ze,overscan:d,size:N.length})},[Ee,ze,d,N.length,xe]),Fe=c.useRef(L);Fe.current=L;var Xe=c.useMemo(function(){for(var h=[],x=function(w,y){var M=re[w],oe=N[M],j=B({},oe,{measureRef:function(Pe){if(Pe){var le=Fe.current(Pe,O);if(le!==j.size){var _e=R.current.scrollOffset;j.start<_e&&I(_e+(le-j.size)),q.current.push(M),te(function(Ze){var ce;return B({},Ze,(ce={},ce[j.key]=le,ce))})}}}});h.push(j)},b=0,m=re.length;b<m;b++)x(b);return h},[re,I,O,N]),Te=c.useRef(!1);X(function(){Te.current&&te({}),Te.current=!0},[l]);var ae=c.useCallback(function(h,x){var b=x===void 0?{align:"start"}:x,m=b.align,z=R.current,w=z.scrollOffset,y=z.outerSize;m==="auto"&&(h<=w?m="start":h>=w+y?m="end":m="start"),m==="start"?W(h):m==="end"?W(h-y):m==="center"&&W(h-y/2)},[W]),ne=c.useCallback(function(h,x){var b=x===void 0?{align:"auto"}:x,m=b.align,z=Kt(b,Xt),w=R.current,y=w.measurements,M=w.scrollOffset,oe=w.outerSize,j=y[Math.max(0,Math.min(h,r-1))];if(j){if(m==="auto")if(j.end>=M+oe)m="end";else if(j.start<=M)m="start";else return;var Me=m==="center"?j.start+j.size/2:m==="end"?j.end:j.start;ae(Me,B({align:m},z))}},[ae,r]),Ye=c.useCallback(function(h,x){ne(h,x),requestAnimationFrame(function(){ne(h,x)})},[ne]);return{virtualItems:Xe,totalSize:Re,scrollToOffset:ae,scrollToIndex:Ye,measure:Qe}},ss=function(e,s,a,r){for(;e<=s;){var o=(e+s)/2|0,l=a(o);if(l<r)e=o+1;else if(l>r)s=o-1;else return o}return e>0?e-1:0};function rs(t){for(var e=t.measurements,s=t.outerSize,a=t.scrollOffset,r=e.length-1,o=function(i){return e[i].start},l=ss(0,r,o,a),u=l;u<r&&e[u].end<a+s;)u++;return{start:l,end:u}}const as=({parentRef:t,size:e})=>{var l,u;const s=ts({parentRef:t,size:e,overscan:15}),{virtualItems:a,totalSize:r}=s,o={top:a.length>0&&((l=a==null?void 0:a[0])==null?void 0:l.start)||0,bottom:a.length>0?r-(((u=a==null?void 0:a[a.length-1])==null?void 0:u.end)||0):0};return{virtualRows:a,padding:o}},ns=(t,e)=>{const{setUsers:s}=Z,[a,r]=c.useState([]),[o,l]=c.useState([]),[u,d]=c.useState(""),[i,v]=c.useState({}),[g,p]=c.useState({}),f=c.useRef(null),C=Gt(),{setColumns:O}=Y,{data:J,loading:ee}=Ht(),k=pt({data:J,columns:C,state:{sorting:a,columnFilters:o,globalFilter:u,columnVisibility:i,rowSelection:g},enableRowSelection:!0,onRowSelectionChange:p,onSortingChange:r,onColumnFiltersChange:l,onGlobalFilterChange:d,onColumnVisibilityChange:v,getCoreRowModel:xt(),getSortedRowModel:St(),getFilteredRowModel:Ct(),getFacetedRowModel:jt(),getFacetedMinMaxValues:kt()}),H=k.getSelectedRowModel().flatRows;c.useEffect(()=>{const E=[];k.getSelectedRowModel().flatRows.map(L=>E.push(L.original)),s(E)},[k,s,H]),c.useEffect(()=>{t==="Член_группы"||t==="Не_член_группы"?k.getColumn("student").setFilterValue(t==="Член_группы"):k.getColumn("student").setFilterValue("")},[k,t,O]),c.useEffect(()=>{var E;(E=k.getColumn("fullname"))==null||E.setFilterValue(e)},[e,k]);const{rows:A}=k.getRowModel(),{virtualRows:K,padding:D}=as({parentRef:f,size:A.length});return{table:k,rows:A,virtualRows:K,padding:D,tableContainerRef:f,loading:ee}},os=ge(({colors:t,colorScheme:e})=>({project:{minWidth:100,background:e==="dark"?t.darkGray[5]:t.gray[2],padding:"10px 15px",borderRadius:5,cursor:"pointer","&:hover":{background:e==="dark"?t.darkGray[4]:t.gray[4],transition:"0.3s"}}})),ls=_(({projects:t})=>{const[e,s]=c.useState([]),{projectsEditorOpened:a,toggleProjectsEditor:r,users:o}=Z,{successNotification:l,errorNotification:u}=Ne(),{classes:d}=os(),{t:i}=T(),{colors:v}=it(),g=f=>{e.includes(f)?s(e.filter(C=>C!==f)):s([...e,f])},p=()=>{if(o.length){const f=o.map(C=>Number(C.id));wt(f,e).then(()=>{l(i("Пользователи добавлены!")),r()}).catch(()=>{u(i("Добавить пользователей не удалось"))})}else u(i("Выберите пользователей."))};return n.jsxs($e,{opened:a,onClose:()=>r(),centered:!0,withCloseButton:!1,children:[n.jsx(P,{fw:500,mb:5,children:i("Проекты")}),n.jsx(P,{fz:14,mb:10,children:i("Отметьте проекты, в которые нужно добавить выбранных пользователей:")}),n.jsx(Ie,{gap:"lg",wrap:"wrap",mah:500,children:t.map(({id:f,name:C})=>n.jsx(de,{className:d.project,onClick:()=>g(f),sx:{border:e.includes(f)?`2px solid ${v.darkBlue[1]}`:"none"},children:C||"Без названия"},f))}),n.jsx(de,{mt:15,children:n.jsx(Ae,{close:()=>r(),saveRights:p})})]})}),cs=_(()=>{const[t,e]=ut(),s={searchParams:t,setSearchParams:e},{t:a}=T(),[r,o]=c.useState([]),{togglePermissionsEditor:l,toggleProjectsEditor:u}=Z,{table:d,rows:i,virtualRows:v,padding:g,tableContainerRef:p,loading:f}=ns($.tableUser,$.searched);return c.useEffect(()=>{Rt().then(({data:C})=>o(C))},[]),n.jsxs(me,{h:"100%",py:"30px",children:[n.jsxs(Ie,{justify:"space-between",mb:10,children:[n.jsxs(dt,{children:[n.jsx(It,{params:s,loading:f}),n.jsxs(G,{visible:f,w:"fit-content",children:[n.jsx(Oe,{onClick:()=>l(),variant:"changePermissions",children:a("Редактировать права")}),n.jsx(Oe,{onClick:()=>u(),variant:"changePermissions",ml:10,children:a("Добавить в проект")})]})]}),n.jsx(Bt,{loading:f})]}),n.jsx(Pt,{table:d,rows:i,virtualRows:v,tableContainerRef:p,loading:f,padding:g}),n.jsx(Ot,{}),n.jsx(ls,{projects:r})]})}),ps=()=>n.jsx(cs,{});export{ps as default};
