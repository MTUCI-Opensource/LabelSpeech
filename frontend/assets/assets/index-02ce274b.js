var st=Object.defineProperty;var rt=(t,e,s)=>e in t?st(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var S=(t,e,s)=>(rt(t,typeof e!="symbol"?e+"":e,s),s);import{k as Y,j as n,m as ge,f as me,C as de,u as at,B as fe,S as nt,s as _,r as c,Q as G,a as F,b as Ie,M as Ve,d as ve,T as P,X as ot,N as lt,Y as Be,Z as ct,$ as it,I as ut,l as be,A as pe,R as Q,p as dt,F as Ge,a0 as ft,G as ht,c as $e}from"./index-f2ed3243.js";import{f as De,T as gt,S as mt,u as vt,g as bt,a as pt,b as xt,c as St,d as Ct}from"./index-512324e5.js";import{C as he}from"./Checkbox-c9cdc4e1.js";import{S as kt}from"./Select-05ae6a18.js";import{u as jt,P as ue}from"./Popover-3fc04823.js";import"./get-select-right-section-props-f93bca52.js";import"./use-input-props-bc703fc5.js";const wt=Y("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),yt=Y("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Rt=Y("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Et=Y("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),xe=({indeterminate:t,...e})=>n.jsx(he,{...e});class zt{constructor(){S(this,"opened",!1);S(this,"isAllColumns",!0);S(this,"columns",[{id:0,label:"checkbox",value:"checkbox",checked:!0},{id:1,label:"ФИО",value:"fullname",checked:!0},{id:2,label:"Роль",value:"role",checked:!0},{id:3,label:"Член группы",value:"student",checked:!0,prevChecked:!0},{id:4,label:"Группа",value:"user_group",checked:!0,prevChecked:!0},{id:5,label:"Количество транскрибаций",value:"transcribations_created",checked:!0},{id:6,label:"Количество верификаций",value:"transcribations_validated",checked:!0},{id:7,label:"Количество классификаций",value:"audio_classified",checked:!0},{id:8,label:"Количество сегментаций",value:"audio_labeled",checked:!0},{id:9,label:"Общее количество",value:"transcribations_total",checked:!0},{id:10,label:"Процент корректных",value:"transcribations_correct",checked:!0}]);S(this,"toggleAllColumns",()=>{this.isAllColumns=!this.isAllColumns,this.columns=this.columns.map(e=>({...e,checked:this.isAllColumns}))});S(this,"setColumns",(e,s,a)=>{this.columns=this.columns.map(r=>a&&e===r.label?{...r,checked:s,prevChecked:s}:r.label===e?{...r,checked:s}:r),this.isAllColumns=this.columns.every(r=>r.checked)});S(this,"setOpenColumnsEdtior",e=>{this.opened=e});ge(this)}}const Z=new zt,Se=me(t=>{const e=t.colorScheme==="dark";return{container:{flex:1,whiteSpace:"nowrap",borderRadius:"10px",position:"static",overflow:"auto","::-webkit-scrollbar":{height:"7px",width:"7px",background:e?"#1C1E26":"inherit"},"::-webkit-scrollbar:horizontal":{borderRadius:"0 0 0 10px"},"::-webkit-scrollbar:vertical":{borderRadius:"0 10px 0 0"},"::-webkit-scrollbar-corner":{width:"10px",height:"10px",borderRadius:"0 0 10px 0",background:e?"#1C1E26":"white"},"::-webkit-scrollbar-thumb":{backgroundColor:e?t.colors.darkGray[4]:t.colors.darkGray[1],borderRadius:"10px"}},table:{position:"static",justifyContent:"center",textAlign:"center",backgroundColor:e?"#1C1E26":"white",color:e?t.colors.gray[4]:"black","thead, tbody":{"th, td":{borderLeft:`.7px solid ${e?t.colors.dark[4]:t.colors.gray[4]}`,borderRight:`.7px solid ${e?t.colors.dark[4]:t.colors.gray[4]}`,":last-of-type":{borderRight:"none"},":first-of-type":{borderLeft:"none"},cursor:"pointer"}}},tableHead:{background:e?"#1C1E26":"white",position:"sticky",zIndex:1,left:0,top:0,"::after":{content:'""',position:"absolute",left:0,bottom:0,height:".7px",background:e?t.colors.dark[4]:t.colors.gray[4],width:"100%"}},tableHeadThChildren:{gap:"8px",color:e?t.colors.gray[3]:"black",fontWeight:500,width:"100%",padding:"10px",textAlign:"center"},headTagDefault:{color:e?t.colors.dark[3]:t.colors.gray[5]},headTag:{color:e?"#5C5F66":t.colors.gray[5],width:14,height:14},tableBodyTr:{":hover":{background:e?"#252832":"#DEE2E640"}},tableHighlitedRow:{background:t.colorScheme==="dark"?"rgba(41, 100, 155, 0.10)":"rgba(231, 245, 255, 0.50)"},checkbox:{margin:"auto",width:0}}}),Mt=({table:t,onClick:e})=>{const{classes:s}=Se();return n.jsx("thead",{className:s.tableHead,children:t.getHeaderGroups().map(a=>n.jsx("tr",{children:a.headers.map(r=>n.jsx("th",{colSpan:r.colSpan,children:r.id==="checkbox"?n.jsx(de,{className:s.tableHeadThChildren,children:n.jsx(xe,{onClick:e,checked:t.getIsAllRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler()})}):n.jsxs(de,{className:s.tableHeadThChildren,onClick:r.column.getToggleSortingHandler(),children:[r.isPlaceholder?null:De(r.column.columnDef.header,r.getContext()),{asc:n.jsx(Rt,{className:s.headTag}),desc:n.jsx(wt,{className:s.headTag})}[r.column.getIsSorted()]??n.jsx(yt,{className:s.headTag})]})},r.id))},a.id))})},Ft=({padding:t,virtualRows:e,rows:s,highlitedRows:a,selectRow:r})=>{const o=at(),{classes:l}=Se();return n.jsxs("tbody",{children:[t.top>0&&n.jsx("tr",{children:n.jsx("td",{style:{height:`${t.top}px`}})}),e.map(u=>{const d=s[u.index];return n.jsx("tr",{className:a.includes(d.id)?l.tableHighlitedRow:l.tableBodyTr,children:d.getVisibleCells().map(i=>i.id===`${i.row.id}_checkbox`?n.jsx("td",{style:{borderTop:0},children:n.jsx(de,{className:l.checkbox,children:n.jsx(xe,{checked:d.getIsSelected(),onClick:()=>r(d.id),onChange:d.getToggleSelectedHandler()})})},i.id):n.jsx("td",{style:{padding:0,borderTop:0,minWidth:i.id===`${i.row.id}_fullname`?"300px":"140px"},children:n.jsx(fe,{p:15,onClick:()=>o(`${nt.admin}/${i.row.original.id}`),children:De(i.column.columnDef.cell,i.getContext())})},i.id))},d.id)}),t.bottom>0&&n.jsx("tr",{children:n.jsx("td",{style:{height:`${t.bottom}px`}})})]})},Tt=_(({table:t,rows:e,virtualRows:s,tableContainerRef:a,loading:r,padding:o})=>{const{classes:l}=Se(),{columns:u}=Z;c.useEffect(()=>{const g=Object.assign({},...u.map(p=>({[p.value]:p.checked})));t.setColumnVisibility(g)},[t,u]);const[d,i]=c.useState([]),v=g=>d.includes(g)?i(d.filter(p=>p!==g)):i([...d,g]);return n.jsx(G,{className:l.container,visible:r,ref:a,children:n.jsxs(gt,{className:l.table,children:[n.jsx(Mt,{table:t,onClick:()=>i([])}),n.jsx(Ft,{padding:o,virtualRows:s,rows:e,highlitedRows:d,selectRow:v})]})})});class Pt{constructor(){S(this,"users",[]);S(this,"permissionEditorOpened",!1);S(this,"projectsEditorOpened",!1);S(this,"setUsers",e=>{this.users=e});S(this,"togglePermissionsEditor",()=>{this.permissionEditorOpened=!this.permissionEditorOpened});S(this,"toggleProjectsEditor",()=>{this.projectsEditorOpened=!this.projectsEditorOpened});ge(this)}}const J=new Pt,_t=_(()=>{const{permissionEditorOpened:t,togglePermissionsEditor:e,users:s}=J,[a,r]=c.useState({transcribation:"user_allow",validation:"user_allow",classify:"user_allow",label:"user_allow"}),[o,l]=c.useState(!1),{t:u}=F(),{successNotification:d,errorNotification:i}=Ie(),v=()=>{if(s.length){const p=s.map(C=>C.id),f={id_list:p,...a};ct(f).then(()=>{d(u("Права пользователя были сохранены."))}).catch(()=>{i(u("Что-то пошло не так."))}),o&&it(p),e()}else i(u("Выберите пользователей."))},g=()=>{e()};return n.jsxs(Ve,{opened:t,onClose:g,withCloseButton:!1,centered:!0,children:[n.jsxs(ve,{p:"0 26px 24px 10px",children:[n.jsx(P,{fw:500,children:u("Редактирование прав")}),n.jsx(P,{fz:12,children:u("Изменения будут применены к выбранным пользователям")}),n.jsx(ot,{tasks:a,setTasks:r}),n.jsx(P,{fw:500,children:u("Выбор роли пользователя:")}),n.jsx(lt,{label:u("Администратор"),onChange:()=>l(!o)})]}),n.jsx(Be,{close:g,saveRights:v})]})}),He=()=>{const t=c.useContext(Ue);if(!t)throw new Error("useParamsContext must be used within ParamsProvider");return t},Ke=({param:t,searchParams:e,setSearchParams:s})=>({handleChange:r=>{e.set(t,(r==null?void 0:r.toString())??""),s(e)}});let Ot=class{constructor(){S(this,"tableUser","Все");S(this,"searched","");ge(this)}setUser(e){this.tableUser=e}setSearched(e){this.searched=e}};const N=new Ot,At=_(()=>{const{searchParams:t,setSearchParams:e}=He(),{t:s}=F(),{handleChange:a}=Ke({param:"user",searchParams:t,setSearchParams:e}),{columns:r,setColumns:o}=Z,l=[{value:"Все",label:s("Все")},{value:"Член_группы",label:s("Член группы")},{value:"Не_член_группы",label:s("Не член группы")}];c.useEffect(()=>N.setUser(t.get("user")),[t]);const u=d=>{a(d),d!=="Не_член_группы"?(o("Член_группы",r[3].prevChecked),o("Группа",r[4].prevChecked)):(o("Член_группы",!1),o("Группа",!1))};return n.jsx(kt,{placeholder:s("Все"),value:N.tableUser,data:l,onChange:u,styles:{input:{borderRadius:10}}})}),Nt=_(()=>{const{searchParams:t,setSearchParams:e}=He(),{t:s}=F(),{handleChange:a}=Ke({param:"search",searchParams:t,setSearchParams:e});return c.useEffect(()=>N.setSearched(t.get("search")),[t]),n.jsx(ut,{w:"30vw",styles:{input:{width:"100%",borderRadius:10}},value:N.searched??"",onChange:r=>a(r.target.value),placeholder:s("Поиск по ФИО"),icon:n.jsx(mt,{size:14})})}),Ue=c.createContext(void 0),$t=({params:t,loading:e})=>n.jsxs(Ue.Provider,{value:t,children:[n.jsx(G,{w:"fit-content",visible:e,sx:{zIndex:1},children:n.jsx(Nt,{})}),n.jsx(G,{w:"fit-content",visible:e,sx:{zIndex:1},children:n.jsx(At,{})})]}),It=me(t=>{const e=t.colorScheme==="dark";return{target:{color:`${e?t.colors.darkBlue[1]:t.colors.blue[5]}`,cursor:"pointer",gap:5,alignItems:"center",width:"fit-content",display:"flex"},title:{color:`${e?t.colors.darkBlue[1]:t.colors.blue[5]}`,fontWeight:500},dropdown:{borderRadius:"10px"}}}),Vt=_(({loading:t})=>{const{columns:e,toggleAllColumns:s,setColumns:a,setOpenColumnsEdtior:r,opened:o,isAllColumns:l}=Z,{classes:u}=It(),d=jt(()=>r(!1)),{t:i}=F();return n.jsxs(ue,{opened:o,children:[n.jsx(ue.Target,{children:n.jsxs(G,{visible:t,onClick:()=>r(!o),className:u.target,children:[n.jsx(P,{className:u.title,children:i("Столбцы таблицы")}),n.jsx(Et,{})]})}),n.jsx(ue.Dropdown,{className:u.dropdown,children:n.jsxs(ve,{ref:d,spacing:15,children:[n.jsx(P,{children:i("Применяемые столбцы")}),n.jsx(he,{label:i("Все столбцы"),checked:l,indeterminate:!l,onChange:s,variant:"filled"}),e.map(({id:v,label:g,checked:p})=>g==="checkbox"?null:n.jsx(he,{label:i(g),checked:p,onChange:()=>a(g,!p,!0),variant:"filled"},v))]})})]})}),Bt=()=>{const{t}=F();return c.useMemo(()=>[{id:"checkbox",header:({table:e})=>n.jsx(xe,{checked:e.getIsAllRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()})},{accessorKey:"fullname",header:t("ФИО"),cell:e=>e.getValue()},{accessorKey:"role",header:t("Роль"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"student",header:t("Член группы"),cell:e=>n.jsx("div",{children:e.getValue()?t("Да"):t("Нет")}),enableGlobalFilter:!1},{accessorKey:"user_group",header:t("Группа"),cell:e=>e.getValue()},{accessorKey:"transcribations_created",header:t("Количество транскрибаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"transcribations_validated",header:t("Количество верификаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"audio_classified",header:t("Количество классификаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"audio_labeled",header:t("Количество сегментаций"),cell:e=>e.getValue(),enableGlobalFilter:!1},{accessorKey:"transcribations_total",header:t("Общее количество"),cell:({row:e})=>Number(e.getValue("transcribations_created"))+Number(e.getValue("transcribations_validated"))+Number(e.getValue("audio_classified"))+Number(e.getValue("audio_labeled")),enableGlobalFilter:!1},{accessorKey:"transcribations_correct",header:t("Процент корректных"),cell:e=>`${(e.getValue()*100).toFixed(2)}%`,enableGlobalFilter:!1}],[t])};function Gt({student:t,student_group:e}){return be.post(pe.statistics,{student:t,student_group:e})}function Dt(){return be.get(pe.allProjects)}function Ht(t,e){return be.post(pe.projectUsers,{user_id:t,project_id:e})}const Kt=()=>{const[t,e]=c.useState([]),[s,a]=c.useState(!0),{t:r}=F();return c.useEffect(()=>{Gt({student:!0,student_group:""}).then(({data:l})=>{e(l)}).catch(l=>l).finally(()=>a(!1))},[]),{data:c.useMemo(()=>t.map(l=>({...l,role:l.role==="admin"?r("Администратор"):r("Пользователь"),transcribations_total:l.transcribations_validated+l.transcribations_created})),[t,r]),loading:s}};/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function B(){return B=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},B.apply(this,arguments)}function Ut(t,e){if(t==null)return{};var s={},a=Object.keys(t),r,o;for(o=0;o<a.length;o++)r=a[o],!(e.indexOf(r)>=0)&&(s[r]=t[r]);return s}var Lt=["bottom","height","left","right","top","width"],qt=function(e,s){return e===void 0&&(e={}),s===void 0&&(s={}),Lt.some(function(a){return e[a]!==s[a]})},M=new Map,Le,Wt=function t(){var e=[];M.forEach(function(s,a){var r=a.getBoundingClientRect();qt(r,s.rect)&&(s.rect=r,e.push(s))}),e.forEach(function(s){s.callbacks.forEach(function(a){return a(s.rect)})}),Le=window.requestAnimationFrame(t)};function Qt(t,e){return{observe:function(){var a=M.size===0;M.has(t)?M.get(t).callbacks.push(e):M.set(t,{rect:void 0,hasRectChanged:!1,callbacks:[e]}),a&&Wt()},unobserve:function(){var a=M.get(t);if(a){var r=a.callbacks.indexOf(e);r>=0&&a.callbacks.splice(r,1),a.callbacks.length||M.delete(t),M.size||cancelAnimationFrame(Le)}}}}var X=typeof window<"u"?c.useLayoutEffect:c.useEffect;function Xt(t,e){var s=e.rect;return t.height!==s.height||t.width!==s.width?s:t}var Yt=function(e,s){s===void 0&&(s={width:0,height:0});var a=Q.useState(e.current),r=a[0],o=a[1],l=Q.useReducer(Xt,s),u=l[0],d=l[1],i=Q.useRef(!1);return X(function(){e.current!==r&&o(e.current)}),X(function(){if(r&&!i.current){i.current=!0;var v=r.getBoundingClientRect();d({rect:v})}},[r]),Q.useEffect(function(){if(r){var v=Qt(r,function(g){d({rect:g})});return v.observe(),function(){v.unobserve()}}},[r]),u},Zt=["align"],Jt=function(){return 50},es=function(e){return e},ts=function(e,s){var a=s?"offsetWidth":"offsetHeight";return e[a]},ss=function(e){for(var s=Math.max(e.start-e.overscan,0),a=Math.min(e.end+e.overscan,e.size-1),r=[],o=s;o<=a;o++)r.push(o);return r},rs=function(e){var s,a=e.size,r=a===void 0?0:a,o=e.estimateSize,l=o===void 0?Jt:o,u=e.overscan,d=u===void 0?1:u,i=e.paddingStart,v=i===void 0?0:i,g=e.paddingEnd,p=g===void 0?0:g,f=e.parentRef,C=e.horizontal,O=C===void 0?!1:C,ee=e.scrollToFn,te=e.useObserver,j=e.initialRect,D=e.onScrollElement,$=e.scrollOffsetFn,H=e.keyExtractor,K=H===void 0?es:H,E=e.measureSize,U=E===void 0?ts:E,Ce=e.rangeExtractor,ke=Ce===void 0?ss:Ce,qe=O?"width":"height",L=O?"scrollLeft":"scrollTop",y=c.useRef({outerSize:0,scrollOffset:0,measurements:[],totalSize:0}),je=c.useState(0),We=je[0],we=je[1];y.current.scrollOffset=We;var Qe=te||Yt,Xe=Qe(f,j),Ye=Xe[qe];y.current.outerSize=Ye;var I=c.useCallback(function(h){f.current&&(f.current[L]=h)},[f,L]),ye=ee||I,q=c.useCallback(function(h){ye(h,I)},[I,ye]),Re=c.useState({}),Ee=Re[0],se=Re[1],Ze=c.useCallback(function(){return se({})},[]),W=c.useRef([]),A=c.useMemo(function(){var h=W.current.length>0?Math.min.apply(Math,W.current):0;W.current=[];for(var x=y.current.measurements.slice(0,h),b=h;b<r;b++){var m=K(b),z=Ee[m],w=x[b-1]?x[b-1].end:v,R=typeof z=="number"?z:l(b),T=w+R;x[b]={index:b,start:w,size:R,end:T,key:m}}return x},[l,Ee,v,r,K]),ze=(((s=A[r-1])==null?void 0:s.end)||v)+p;y.current.measurements=A,y.current.totalSize=ze;var V=D?D.current:f.current,re=c.useRef($);re.current=$,X(function(){if(!V){we(0);return}var h=function(b){var m=re.current?re.current(b):V[L];we(m)};return h(),V.addEventListener("scroll",h,{capture:!1,passive:!0}),function(){V.removeEventListener("scroll",h)}},[V,L]);var Me=ns(y.current),Fe=Me.start,Te=Me.end,ae=c.useMemo(function(){return ke({start:Fe,end:Te,overscan:d,size:A.length})},[Fe,Te,d,A.length,ke]),Pe=c.useRef(U);Pe.current=U;var Je=c.useMemo(function(){for(var h=[],x=function(w,R){var T=ae[w],le=A[T],k=B({},le,{measureRef:function(Ae){if(Ae){var ce=Pe.current(Ae,O);if(ce!==k.size){var Ne=y.current.scrollOffset;k.start<Ne&&I(Ne+(ce-k.size)),W.current.push(T),se(function(tt){var ie;return B({},tt,(ie={},ie[k.key]=ce,ie))})}}}});h.push(k)},b=0,m=ae.length;b<m;b++)x(b);return h},[ae,I,O,A]),_e=c.useRef(!1);X(function(){_e.current&&se({}),_e.current=!0},[l]);var ne=c.useCallback(function(h,x){var b=x===void 0?{align:"start"}:x,m=b.align,z=y.current,w=z.scrollOffset,R=z.outerSize;m==="auto"&&(h<=w?m="start":h>=w+R?m="end":m="start"),m==="start"?q(h):m==="end"?q(h-R):m==="center"&&q(h-R/2)},[q]),oe=c.useCallback(function(h,x){var b=x===void 0?{align:"auto"}:x,m=b.align,z=Ut(b,Zt),w=y.current,R=w.measurements,T=w.scrollOffset,le=w.outerSize,k=R[Math.max(0,Math.min(h,r-1))];if(k){if(m==="auto")if(k.end>=T+le)m="end";else if(k.start<=T)m="start";else return;var Oe=m==="center"?k.start+k.size/2:m==="end"?k.end:k.start;ne(Oe,B({align:m},z))}},[ne,r]),et=c.useCallback(function(h,x){oe(h,x),requestAnimationFrame(function(){oe(h,x)})},[oe]);return{virtualItems:Je,totalSize:ze,scrollToOffset:ne,scrollToIndex:et,measure:Ze}},as=function(e,s,a,r){for(;e<=s;){var o=(e+s)/2|0,l=a(o);if(l<r)e=o+1;else if(l>r)s=o-1;else return o}return e>0?e-1:0};function ns(t){for(var e=t.measurements,s=t.outerSize,a=t.scrollOffset,r=e.length-1,o=function(i){return e[i].start},l=as(0,r,o,a),u=l;u<r&&e[u].end<a+s;)u++;return{start:l,end:u}}const os=({parentRef:t,size:e})=>{var l,u;const s=rs({parentRef:t,size:e,overscan:15}),{virtualItems:a,totalSize:r}=s,o={top:a.length>0&&((l=a==null?void 0:a[0])==null?void 0:l.start)||0,bottom:a.length>0?r-(((u=a==null?void 0:a[a.length-1])==null?void 0:u.end)||0):0};return{virtualRows:a,padding:o}},ls=(t,e)=>{const{setUsers:s}=J,[a,r]=c.useState([]),[o,l]=c.useState([]),[u,d]=c.useState(""),[i,v]=c.useState({}),[g,p]=c.useState({}),f=c.useRef(null),C=Bt(),{setColumns:O}=Z,{data:ee,loading:te}=Kt(),j=vt({data:ee,columns:C,state:{sorting:a,columnFilters:o,globalFilter:u,columnVisibility:i,rowSelection:g},enableRowSelection:!0,onRowSelectionChange:p,onSortingChange:r,onColumnFiltersChange:l,onGlobalFilterChange:d,onColumnVisibilityChange:v,getCoreRowModel:bt(),getSortedRowModel:pt(),getFilteredRowModel:xt(),getFacetedRowModel:St(),getFacetedMinMaxValues:Ct()}),D=j.getSelectedRowModel().flatRows;c.useEffect(()=>{const E=[];j.getSelectedRowModel().flatRows.map(U=>E.push(U.original)),s(E)},[j,s,D]),c.useEffect(()=>{t==="Член_группы"||t==="Не_член_группы"?j.getColumn("student").setFilterValue(t==="Член_группы"):j.getColumn("student").setFilterValue("")},[j,t,O]),c.useEffect(()=>{var E;(E=j.getColumn("fullname"))==null||E.setFilterValue(e)},[e,j]);const{rows:$}=j.getRowModel(),{virtualRows:H,padding:K}=os({parentRef:f,size:$.length});return{table:j,rows:$,virtualRows:H,padding:K,tableContainerRef:f,loading:te}},cs=me(({colors:t,colorScheme:e})=>({project:{minWidth:100,background:e==="dark"?t.darkGray[5]:t.gray[2],padding:"10px 15px",borderRadius:5,cursor:"pointer","&:hover":{background:e==="dark"?t.darkGray[4]:t.gray[4],transition:"0.3s"}}})),is=_(({projects:t})=>{const[e,s]=c.useState([]),{projectsEditorOpened:a,toggleProjectsEditor:r,users:o}=J,{successNotification:l,errorNotification:u}=Ie(),{classes:d}=cs(),{t:i}=F(),{colors:v}=dt(),g=f=>{e.includes(f)?s(e.filter(C=>C!==f)):s([...e,f])},p=()=>{if(o.length){const f=o.map(C=>Number(C.id));Ht(f,e).then(()=>{l(i("Пользователи добавлены!")),r()}).catch(()=>{u(i("Добавить пользователей не удалось"))})}else u(i("Выберите пользователей."))};return n.jsxs(Ve,{opened:a,onClose:()=>r(),centered:!0,withCloseButton:!1,children:[n.jsx(P,{fw:500,mb:5,children:i("Проекты")}),n.jsx(P,{fz:14,mb:10,children:i("Отметьте проекты, в которые нужно добавить выбранных пользователей:")}),n.jsx(Ge,{gap:"lg",wrap:"wrap",mah:500,children:t.map(({id:f,name:C})=>n.jsx(fe,{className:d.project,onClick:()=>g(f),sx:{border:e.includes(f)?`2px solid ${v.darkBlue[1]}`:"none"},children:C||"Без названия"},f))}),n.jsx(fe,{mt:15,children:n.jsx(Be,{close:()=>r(),saveRights:p})})]})}),us=_(()=>{const[t,e]=ft(),s={searchParams:t,setSearchParams:e},{t:a}=F(),[r,o]=c.useState([]),{togglePermissionsEditor:l,toggleProjectsEditor:u}=J,{table:d,rows:i,virtualRows:v,padding:g,tableContainerRef:p,loading:f}=ls(N.tableUser,N.searched);return c.useEffect(()=>{Dt().then(({data:C})=>o(C))},[]),n.jsxs(ve,{h:"100%",py:"30px",children:[n.jsxs(Ge,{justify:"space-between",mb:10,children:[n.jsxs(ht,{children:[n.jsx($t,{params:s,loading:f}),n.jsxs(G,{visible:f,w:"fit-content",children:[n.jsx($e,{onClick:()=>l(),variant:"changePermissions",children:a("Редактировать права")}),n.jsx($e,{onClick:()=>u(),variant:"changePermissions",ml:10,children:a("Добавить в проект")})]})]}),n.jsx(Vt,{loading:f})]}),n.jsx(Tt,{table:d,rows:i,virtualRows:v,tableContainerRef:p,loading:f,padding:g}),n.jsx(_t,{}),n.jsx(is,{projects:r})]})}),Ss=()=>n.jsx(us,{});export{Ss as default};
